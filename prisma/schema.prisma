// =======================
// ‚öôÔ∏è Prisma Configuration
// =======================
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =======================
// üë• Anggota & Jabatan
// =======================
model Jabatan {
  id       Int       @id @default(autoincrement())
  nama     String
  anggota  Anggota[]

  @@map("jabatan")
}

model Anggota {
  id          Int        @id @default(autoincrement())
  id_jabatan  Int
  nama        String
  email       String     @unique
  password    String
  alamat      String?
  no_hp       String?

  // Relasi
  jabatan     Jabatan    @relation(fields: [id_jabatan], references: [id])
  tabungan    Tabungan[]
  pinjaman    Pinjaman[]
  penarikan   Penarikan[]

  @@map("anggota")
}

// =======================
// üí∞ Tabungan & Penarikan
// =======================
model KategoriSimpanan {
  id        Int         @id @default(autoincrement())
  nama      String
  tabungan  Tabungan[]

  @@map("kategori_simpanan")
}

model Tabungan {
  id                    Int              @id @default(autoincrement())
  id_anggota            Int
  id_kategori_simpanan  Int
  tanggal               DateTime
  jumlah                Float
  note                  String?

  // Relasi
  anggota               Anggota          @relation(fields: [id_anggota], references: [id])
  kategoriSimpanan      KategoriSimpanan @relation(fields: [id_kategori_simpanan], references: [id])
  penarikan             Penarikan[]

  @@map("tabungan")
}

model Penarikan {
  id          Int       @id @default(autoincrement())
  id_anggota  Int
  id_tabungan Int
  tanggal     DateTime
  jumlah      Float
  note        String?

  // Relasi
  anggota     Anggota   @relation(fields: [id_anggota], references: [id])
  tabungan    Tabungan  @relation(fields: [id_tabungan], references: [id])

  @@map("penarikan")
}

// =======================
// üí∏ Pinjaman & Angsuran
// =======================
model KategoriJangkaWaktu {
  id        Int         @id @default(autoincrement())
  nama      String
  pinjaman  Pinjaman[]

  @@map("kategori_jangka_waktu")
}

model Pinjaman {
  id                    Int                 @id @default(autoincrement())
  id_anggota            Int
  id_jangka_waktu       Int
  tanggal               DateTime
  jumlah                Float
  status                String
  note                  String?
  tanggal_jatuh_tempo   DateTime

  // Relasi
  anggota               Anggota             @relation(fields: [id_anggota], references: [id])
  jangkaWaktu           KategoriJangkaWaktu @relation(fields: [id_jangka_waktu], references: [id])
  angsuran              Angsuran[]

  @@map("pinjaman")
}

model Angsuran {
  id                  Int       @id @default(autoincrement())
  pinjaman_id         Int
  tanggal_pembayaran  DateTime
  jumlah_pembayaran   Float
  sisa_pinjaman       Float
  note                String?

  // Relasi
  pinjaman            Pinjaman  @relation(fields: [pinjaman_id], references: [id])

  @@map("angsuran")
}

// =======================
// üè¶ Kas Koperasi
// =======================
model KasKoperasi {
  id       Int       @id @default(autoincrement())
  nominal  Float
  tanggal  DateTime
  note     String?

  @@map("kas_koperasi")
}
